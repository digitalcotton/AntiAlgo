---
name: output-schema
description: Defines file formats and folder structure for capturing all agent and sub-agent outputs
---

# Output Schema

## Purpose

Ensure **all data generated by agents and sub-agents is captured** in structured files for review. Every pipeline run produces:

1. **Pipeline Log** (`pipeline_log.md`) â€” Full conversation with all messages
2. **Final Report** (`final_report.md`) â€” Executive summary + E/I map + roadmap
3. **Structured Data** (`*.json`) â€” Machine-readable outputs for analysis

---

## Folder Structure

```
outputs/
â”œâ”€â”€ runs/
â”‚   â””â”€â”€ {YYYY-MM-DD_HH-MM}_{agent-title}/
â”‚       â”‚
â”‚       â”œâ”€â”€ pipeline_log.md              # Full real-time message log
â”‚       â”œâ”€â”€ final_report.md              # Synthesized deliverable
â”‚       â”œâ”€â”€ run_metadata.json            # Run info (timestamps, mode, idea)
â”‚       â”‚
â”‚       â”œâ”€â”€ effort_impact/
â”‚       â”‚   â”œâ”€â”€ master_map.md            # Human-readable E/I matrix
â”‚       â”‚   â””â”€â”€ master_map.json          # Structured E/I data
â”‚       â”‚
â”‚       â”œâ”€â”€ agents/
â”‚       â”‚   â”œâ”€â”€ steve_jobs/
â”‚       â”‚   â”‚   â”œâ”€â”€ output.md            # Full agent output
â”‚       â”‚   â”‚   â”œâ”€â”€ output.json          # Structured data
â”‚       â”‚   â”‚   â””â”€â”€ ideas.json           # Generated ideas
â”‚       â”‚   â”œâ”€â”€ jony_ive/
â”‚       â”‚   â”‚   â”œâ”€â”€ output.md
â”‚       â”‚   â”‚   â”œâ”€â”€ output.json
â”‚       â”‚   â”‚   â””â”€â”€ ideas.json
â”‚       â”‚   â””â”€â”€ wozniak/
â”‚       â”‚       â”œâ”€â”€ output.md
â”‚       â”‚       â”œâ”€â”€ output.json
â”‚       â”‚       â””â”€â”€ ideas.json
â”‚       â”‚
â”‚       â”œâ”€â”€ subagents/
â”‚       â”‚   â”œâ”€â”€ market_intel.json
â”‚       â”‚   â”œâ”€â”€ competitive_recon.json
â”‚       â”‚   â”œâ”€â”€ gtm_strategist.json
â”‚       â”‚   â”œâ”€â”€ pattern_scout.json
â”‚       â”‚   â”œâ”€â”€ design_system_intel.json
â”‚       â”‚   â”œâ”€â”€ narrative_signal.json
â”‚       â”‚   â”œâ”€â”€ web_scout.json
â”‚       â”‚   â”œâ”€â”€ source_triangulator.json
â”‚       â”‚   â””â”€â”€ dependency_intel.json
â”‚       â”‚
â”‚       â”œâ”€â”€ handoffs/
â”‚       â”‚   â”œâ”€â”€ 01_orchestrator_to_jobs.json
â”‚       â”‚   â”œâ”€â”€ 02_jobs_to_ive.json
â”‚       â”‚   â”œâ”€â”€ 03_ive_to_woz.json
â”‚       â”‚   â””â”€â”€ 04_woz_to_orchestrator.json
â”‚       â”‚
â”‚       â””â”€â”€ conflicts/
â”‚           â””â”€â”€ conflict_{n}.json        # Each conflict + resolution
â”‚
â”œâ”€â”€ reports/
â”‚   â””â”€â”€ {YYYY-MM-DD}_{agent-title}_report.md   # Shareable final reports
â”‚
â””â”€â”€ memory/
    â”œâ”€â”€ persistent/                      # Survives session reset
    â”‚   â”œâ”€â”€ product_decisions.json       # Intentional decisions to keep
    â”‚   â”œâ”€â”€ architecture_decisions.json  # ADRs
    â”‚   â””â”€â”€ constraints.json             # Requirements, non-negotiables
    â”‚
    â””â”€â”€ session/                         # Cleared on reset
        â”œâ”€â”€ handoff_context.json         # Current run handoffs
        â”œâ”€â”€ conversation_state.json      # Intermediate notes
        â””â”€â”€ working_memory.json          # Temporary calculations
```

---

## Run Naming Convention

**Format:** `{YYYY-MM-DD_HH-MM}_{agent-title}`

- **Timestamp:** ISO-8601 date + time (24hr)
- **Agent Title:** Generated by Orchestrator based on idea essence

**Examples:**
```
2026-02-05_14-30_curious-newsletter
2026-02-05_16-45_ai-commit-messages
2026-02-06_09-15_team-standup-bot
```

**Title Generation Rules:**
- Lowercase, hyphenated
- Max 30 characters
- No special characters
- Derived from North Star or user's original idea

---

## File Formats

### run_metadata.json

```json
{
  "run_id": "uuid-v4",
  "created_at": "2026-02-05T14:30:00Z",
  "completed_at": "2026-02-05T14:35:00Z",
  "duration_seconds": 300,
  "mode": "deep",
  "verbosity": "agents",
  
  "user_input": {
    "raw": "Original user input text",
    "interpreted": "Clarified version"
  },
  
  "title": "curious-newsletter",
  "north_star": "Discover what 10,000 curious minds asked AI this week",
  
  "agents_invoked": ["steve-jobs", "jony-ive", "wozniak"],
  "subagents_invoked": ["market-intel", "competitive-recon", "pattern-scout", "web-scout"],
  
  "outputs": {
    "ideas_count": 13,
    "quick_wins": 7,
    "big_bets": 4,
    "fill_ins": 4,
    "money_pits": 0,
    "conflicts_resolved": 1
  },
  
  "memory_commits": [
    "curious_newsletter_vision_v1",
    "curious_design_system_v1",
    "curious_architecture_v1"
  ]
}
```

### pipeline_log.md

Full conversation log with all agent messages in chronological order.

```markdown
# Pipeline Log: {title}

**Run ID:** {uuid}
**Started:** {timestamp}
**Mode:** {mode}

---

## Phase 0: Context Load

â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ ğŸ“– ORCHESTRATOR                                    00:00:00 â”‚
â”‚ Signal: MEMORY_CHECK                                        â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ Searching for related past decisions...                     â”‚
â”‚ Found: 0 relevant entries                                   â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

## Phase 1: Vision (Steve-Jobs)

[... all messages in order ...]

## Phase 2: Design (Jony-Ive)

[... all messages in order ...]

## Phase 3: Engineering (Wozniak)

[... all messages in order ...]

## Phase 4: Synthesis

[... all messages in order ...]

---

**Completed:** {timestamp}
**Duration:** {seconds}s
```

### final_report.md

Shareable deliverable with executive summary, specs, and roadmap.

```markdown
# Product Specification: {Title}

**Generated:** {date}
**Run ID:** {uuid}

---

## Executive Summary

| Field | Value |
|-------|-------|
| Product | ... |
| For | ... |
| Problem | ... |
| Solution | ... |
| Differentiation | ... |

---

## Master Effort/Impact Map

### ğŸš€ Quick Wins
[table]

### ğŸ¯ Big Bets
[table]

### ğŸ“‹ Fill-ins
[table]

### ğŸš« Money Pits
[table]

---

## Product Specification

### Vision (Steve-Jobs)
[content]

### Design (Jony-Ive)
[content]

### Engineering (Wozniak)
[content]

---

## Implementation Roadmap

[phased plan]

---

## Open Questions

[list]

---

## Appendix

- Full pipeline log: `./pipeline_log.md`
- Effort/Impact data: `./effort_impact/master_map.json`
- Agent outputs: `./agents/`
```

### Agent Output Files

**output.md** â€” Human-readable full output:
```markdown
# Steve-Jobs Agent Output

**Phase:** Vision
**Duration:** 45s

## North Star
...

## MVP Features
...

## Generated Ideas
...

## Effort/Impact Scores
...

## Jobs Verdict
...
```

**output.json** â€” Structured data:
```json
{
  "agent": "steve-jobs",
  "phase": "vision",
  "duration_seconds": 45,
  "north_star": "...",
  "positioning": "...",
  "mvp_features": [...],
  "non_negotiables": [...],
  "anti_goals": [...],
  "pmf_blueprint": {...},
  "verdict": {
    "simplify": [...],
    "ten_x": [...],
    "kill": [...]
  }
}
```

**ideas.json** â€” Generated ideas:
```json
{
  "agent": "steve-jobs",
  "ideas": [
    {
      "id": "idea-001",
      "title": "Curiosity Score",
      "type": "feature",
      "description": "...",
      "rationale": "...",
      "effort": 2,
      "impact": 5,
      "quadrant": "quick-win"
    }
  ]
}
```

### Sub-Agent Output Files

**market_intel.json:**
```json
{
  "subagent": "market-intel",
  "parent": "steve-jobs",
  "query": "newsletter market size 2025...",
  "duration_seconds": 16,
  "sources": [
    {"url": "...", "title": "...", "snippet": "..."}
  ],
  "findings": {
    "tam": "$12B",
    "sam": "$800M",
    "som_year1": "$1.2M",
    "why_now_signals": [...],
    "funding_activity": [...],
    "user_pain_points": [...]
  },
  "confidence": "high",
  "timestamp": "2026-02-05T14:30:18Z"
}
```

### Handoff Files

**01_orchestrator_to_jobs.json:**
```json
{
  "handoff_id": "h-001",
  "from": "orchestrator",
  "to": "steve-jobs",
  "timestamp": "2026-02-05T14:30:00Z",
  "payload": {
    "user_idea": {...},
    "mode": "deep",
    "instructions": {...}
  }
}
```

### Conflict Files

**conflict_1.json:**
```json
{
  "conflict_id": "c-001",
  "timestamp": "2026-02-05T14:33:06Z",
  "issue": "Custom animation system",
  "agents": {
    "jony-ive": {
      "position": "Custom spring physics",
      "effort": 3,
      "impact": 4
    },
    "wozniak": {
      "position": "Use CSS transitions",
      "effort": 5,
      "impact": 3
    }
  },
  "rule_applied": "Ive wins if <20% more effort, else Woz",
  "winner": "wozniak",
  "resolution": "Use CSS transitions with subtle easing",
  "compromise": "Ive to spec exact easing curve"
}
```

---

## Memory Management

### Persistent Memory (Survives Reset)

Stored in `outputs/memory/persistent/`:

| File | Contents | When Written |
|------|----------|--------------|
| `product_decisions.json` | Explicit "we decided X" statements | On user confirmation |
| `architecture_decisions.json` | ADRs (tech stack, patterns) | On Woz phase complete |
| `constraints.json` | Non-negotiables, requirements | On Jobs phase complete |

**Example product_decisions.json:**
```json
{
  "decisions": [
    {
      "id": "pd-001",
      "date": "2026-02-05",
      "product": "curious-newsletter",
      "decision": "Newsletter, not app",
      "rationale": "Lower friction, proven model",
      "made_by": "steve-jobs",
      "confidence": "high",
      "supersedes": null
    }
  ]
}
```

### Session Memory (Cleared on Reset)

Stored in `outputs/memory/session/`:

| File | Contents | Lifecycle |
|------|----------|-----------|
| `handoff_context.json` | Current run handoffs | Cleared after run |
| `conversation_state.json` | Intermediate notes | Cleared after run |
| `working_memory.json` | Temporary calculations | Cleared after run |

---

## Session Reset Protocol

After pipeline completion, the Orchestrator:

1. **Writes final outputs** to `outputs/runs/{timestamp}_{title}/`
2. **Copies shareable report** to `outputs/reports/`
3. **Commits persistent decisions** to `outputs/memory/persistent/`
4. **Clears session memory:**
   ```
   rm outputs/memory/session/*.json
   ```
5. **Logs reset:**
   ```
   â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
   â”‚ ğŸ”„ ORCHESTRATOR                                    00:05:00 â”‚
   â”‚ Signal: SESSION_RESET                                       â”‚
   â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
   â”‚ âœ… Final report saved: outputs/runs/2026-02-05_14-30_.../   â”‚
   â”‚ âœ… Persistent memory updated: 3 decisions committed         â”‚
   â”‚ âœ… Session memory cleared                                   â”‚
   â”‚ ğŸ†• Ready for new idea                                       â”‚
   â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
   ```

### What Gets Reset vs Kept

| Data Type | Reset? | Location |
|-----------|--------|----------|
| Handoff payloads | âœ… Yes | session/ |
| Conversation state | âœ… Yes | session/ |
| Working calculations | âœ… Yes | session/ |
| Product decisions | âŒ No | persistent/ |
| Architecture decisions | âŒ No | persistent/ |
| Constraints | âŒ No | persistent/ |
| Past run outputs | âŒ No | runs/ |

---

## Output Write Protocol

Every agent MUST call `output_write` at phase completion:

```yaml
output_write:
  run_folder: "{current_run_path}"
  agent: "steve-jobs"
  files:
    - path: "agents/steve_jobs/output.md"
      content: "{full markdown output}"
    - path: "agents/steve_jobs/output.json"
      content: "{structured json}"
    - path: "agents/steve_jobs/ideas.json"
      content: "{ideas array}"
```

Sub-agents MUST emit research results:

```yaml
output_write:
  run_folder: "{current_run_path}"
  subagent: "market-intel"
  files:
    - path: "subagents/market_intel.json"
      content: "{research data}"
```

---

## Accessing Outputs

### For Humans

```bash
# View latest run
ls -la outputs/runs/ | tail -1

# Read final report
cat outputs/runs/2026-02-05_14-30_curious-newsletter/final_report.md

# Review all ideas
cat outputs/runs/*/agents/*/ideas.json | jq '.ideas[]'
```

### For Agents (Future Runs)

```yaml
# Orchestrator Phase 0: Context Load
memory_search:
  scope: "persistent"
  query: "newsletter decisions"
  
# Returns relevant past decisions without session contamination
```
